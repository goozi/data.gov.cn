<%@ page contentType="text/html; charset=GBK" %>
<%@ include file="../include.jsp" %>
<%@ page import="com.dhccity.base.entity.BaseType" %>
<%
	String code =req.getString("code");
	int state=req.getInt("state")==-1?-1:1;
	String name=code.equals("DUTY")?"职务":"角色";
	BaseType oBaseType =(BaseType) new  BaseType().findByCode(code);
    Iterator it=new BaseType().findAllChildType(code,state).iterator();
	
%>
<html xmlns:kingtop>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<LINK  href="../style/default.css" rel=stylesheet>
<link rel="stylesheet" href="../htc/default.jss" type="text/css">
<title><%=Config.SystemName%></title>
</head>
<body leftmargin="0" topmargin="0">
<br>
<br>
<table width="95%" border="0" align="center" cellpadding="0" cellspacing="0">
  <tr> 
    <td width="72%" height="29" valign="middle"> <input type=button class="btn"  onClick="openCenter('group_add.jsp?parentId=<%=oBaseType.getId()%>','',210,700);"  border="0" name="add" value="新建" > 
      <input type=button class="btn"  onClick="editData(document.getElementsByName('idArray'),'group_edit.jsp?id=',210,700)"  border="0" name="edit" value="编辑" > 
    </td>
    <td width="72%" align="right" valign="middle"> <input type="checkbox" value="-1" name="state" onClick="doChange()" <%=state==-1?"checked":""%>>
      显示已删除<%=name%></td>
  </tr>
</table>
<table width="95%" border="0" align=center cellpadding=0 cellspacing=1  class="listTree"  style="behavior:url(../htc/treeTable.htc)" FilesDir="../htc" startcol="1"  expancelevel="2">
  <tbody>
    <tr class="title"   > 
      <td  width="5%">选择</td>
      <td  width="51%" ><%=name%>名称</td>
      <td>顺序种子</td>
      <td  height=24>有效</td>
    </tr>
    <%      
    while(it.hasNext())
	{
		BaseType baseType=(BaseType) it.next();%>
    <tr level="<%=baseType.getLevel()%>" isLeaf="<%=baseType.isLeaf()%>" html="<%=baseType.getLevelHtml()%>"> 
      <td align="center" ><input name="idArray" type="checkbox" value="<%=baseType.getId()%>"></td>
      <td width="51%" align="left"><%=baseType.getName()%></td>
      <td width="29%"><%=baseType.getSequ()%></td>
      <td width="15%"><%=baseType.getState()==1?"√":"×"%></td>
    </tr>
    <%
    }
%>
  </tbody>
</table>
</body>
</html>
<script>
function doChange()
{
	if (document.all("state").checked)
		location.href="group_list.jsp?code=<%=code%>&state=-1" ;
	else
		location.href="group_list.jsp?code=<%=code%>&state=1" ;
}
</script>