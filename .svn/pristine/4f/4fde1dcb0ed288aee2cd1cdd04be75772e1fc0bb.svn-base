package com.dhccity.app.servlet;
import java.io.*;
import java.util.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.light.*;
import com.dhccity.app.entity.App;
/**
 * <p>Title: App对象管理Servlet类</p>
 * <p>Description:</p>:);
 * <p>Company: Kingtop</p>
 * <p>CreateDate: 2015-05-18 16:46:50</p>
 * @author Zerrion
 * @version 1.0
 */
public class AppAction extends ServletAction
{
	private final String SYSTEM_NAME = "";
	private final String MODULE_NAME = "";
	private final int WINDOW_TYPE = 1; //0表示无效、1表示调转、2表示关闭

	/**
	 * 增加一条数据
	 */
	public void addData(HttpRequest request, HttpServletResponse response, User user) throws ServletException, IOException
	{
		String name = request.getString("name");
		String cnName = request.getString("cnName");
		String desc = request.getString("desc");
		String url = request.getString("url");
		String developer = request.getString("developer");
		long submitterId = request.getLong("submitterId");
		long appThumbnail = request.getLong("appThumbnail");
		long appPic = request.getLong("appPic");
		long appCharge = request.getLong("appCharge");
		long category = request.getLong("category");

		//新建一个对象
		App app = new App();
		app.setName(name);
		app.setCnName(cnName);
		app.setDesc(desc);
		app.setUrl(url);
		app.setDeveloper(developer);
		app.setSubmitterId(submitterId);
		app.setAppThumbnail(appThumbnail);
		app.setAppPic(appPic);
		app.setAppCharge(appCharge);
		app.setCategory(category);
		app.add(); //增加记录

		user.addLog(SYSTEM_NAME, MODULE_NAME, "增加记录[]");
		doReturn(response, WINDOW_TYPE, "app_list.jsp");
	}

	/**
	 * 修改指定数据
	 */
	public void updateData(HttpRequest request, HttpServletResponse response, User user) throws ServletException, IOException
	{
		long id = request.getLong("id");
		String name = request.getString("name");
		String cnName = request.getString("cnName");
		String desc = request.getString("desc");
		String url = request.getString("url");
		String developer = request.getString("developer");
		long submitterId = request.getLong("submitterId");
		long appThumbnail = request.getLong("appThumbnail");
		long appPic = request.getLong("appPic");
		long appCharge = request.getLong("appCharge");
		long category = request.getLong("category");

		//新建一个对象
		App app = (App) new App().findById(id);
		app.setId(id);
		app.setName(name);
		app.setCnName(cnName);
		app.setDesc(desc);
		app.setUrl(url);
		app.setDeveloper(developer);
		app.setSubmitterId(submitterId);
		app.setAppThumbnail(appThumbnail);
		app.setAppPic(appPic);
		app.setAppCharge(appCharge);
		app.setCategory(category);
		app.update(); //修改记录

		user.addLog(SYSTEM_NAME, MODULE_NAME, "修改记录[]");
		doReturn(response, WINDOW_TYPE, "app_list.jsp");
	}

	/**
	 * 删除数据
	 */
	public void deleteData(HttpRequest request, HttpServletResponse response, User user) throws ServletException, IOException
	{
		long[] idArray = request.getLongArray("idArray");
		String log = "";

		//新建一个对象
		App app = new App();
		if (idArray != null)
		{
			for (int i = 0; i < idArray.length; i++)
			{
				app.delete(idArray[i]); //删除记录
				log += idArray[i] + ";";
			}
		}

		user.addLog(SYSTEM_NAME, MODULE_NAME, "删除记录[" + log + "]");
	}
}
